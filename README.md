# Project 3
Consists of multiple files, the most important of which include views.py: the main python django application, urls.py: the python file that maps the views to the html files for django, models.py: the python file that defines the database models that define the tables to hold the data which django will create using sqlite, apps.py: the python file that defines the application (and folders) including orders and users, and admin.py: the python file that registers the models for django. In addition, folders for the orders and users applications that include the files that go along with the apps: templates which includes all the html files to format and display the apps, migrations which includes the database migration files to create the data and tables, as well as static which includes the css and javascript files needed for the apps.

# orders folder
# views.py
File run within django to start the python application. It consists of the view definitions, data processing, database maganement, and data setup for the html files. 

index(): first checks if the user is authenticated and if not, it indicates no user so the html can prevent access to links that require a login. If authenticated, gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. Otherwise, it gets the superuser or admin info for the user. If the user is NOT a superuser, then it checks to see if there are any orders in the cart for the given user. If so, it gets the order_id, count and total for the orders in the cart. If not, then it checks to see if there are any orders overall and if so, it sets the session information with 0s for the count and total grabs the last order_id so it can set the next order_id as well for the session. It then sets up the display information for the entire menu, including the cart count, username, and all menu information and calls orders/index.html.

register(): get method creates a form to get the first name, last name, username, password and email from the user and calls users/register.html. The post method grabs the user input and if the username is not already registered,it then creates a new user in the user database and calls orders/index.html. Otherwise, it calls users/register.html and sends an error message to the user indicating the username already exists.

login(): get method creates a form to get the username and password for the given user and calls users/login.html. The post method then grabs the user input and if the credentials are valid, it calls orders/index.html. Otherwise, it asks the user for correct credentials.

logout(): 0s out the session information and logs the user out of the application and calls users/logout.html.

view_order(): first checks if the user is authenticated and if not, it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it then checks if the user is a superuser or not. If so, it checks for existing orders that are not in the cart and not cancelled. If not a superuser, it checks for existing orders for the given user that are not in the cart and not cancelled. If found, it  sets up the display information for all orders based on their status and calls orders/viewOrder.html. If no orders are found, it calls orders/error.html.

order_status(): this method is only available to superusers so there is no check. The post method gets the username and input for the order_id and update_item from the user's selections. If the user selected an item, then it checks if the item is in the database. If not, it sends an error to orders/error.html. Otherwise, it increments the order status for the item in the db and saves. It then checks if the item is pizza or subs and if so, it advances the status of the toppings as well. It then checks the new status and if it is Completed, it reverse calls orders/viewOrder.html since the status can not be updated further. Otherwise, it checks that an order_id was sent and if so, reverse calls orders/orderStatus.html with order_id so user can review and update status for the given order_id. If no order_id sent, then it calls orders/viewOrder.html. The get method checks if the user is authenticated and if not, it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it then checks if an order_id was sent. If so, it sets up the display information for the given order. Otherwise, it sets up the display information with a 0 order_id so the user will be prompted to enter the order_id to update. Either was it calls orders/orderStatus.html with the display info setup.

view_cart(): this method is only available to non-superusers so there is no check. The post method gets username and input for the remove_item from the user's selections. If the user selected an item, then it checks if the item is in the database. If not, it sends an error to orders/error.html. Otherwise, it sets the status to cancelled in the db and saves. It then checks if the item is pizza or subs and if so, it sets the status of the toppings as well. It also updates the session variable for the total and the count. If there are no items left in the cart, it reverse calls orders/index.html. Otherwise it reverse calls orders/viewCart.html. The get method checks if the user is authenticated and if not, it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it then checks the count and if it is 0 it sends an error to orders/error.html. If it is > 0, it sets up the display information for the cart and calls orders/viewCart.html with the display info setup.

place_order(): this method is only available to non-superusers so there is no check. The post method grabs the session varaiables and then gets all the items in the cart. If no items are found for the cart in the db, it sends an error to orders/error.html. Otherwise, it sets the status to submitted for all order items in the db and saves. It then clears the session variables so they can be formatted correctly for next order. It then calls orders/success.html to indicate the order was successfully submitted. Otherwise it calls orders/error.html. The get method checks if the user is authenticated and if not, it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it then gets the session variables and if the count is 0 it sends an error to orders/error.html. If it is > 0, it sets up the display information for the cart and calls orders/placeOrder.html with the display info setup.

reg_pizza(): this method is only available to non-superusers so there is no check. The post method grabs the username and input for the num_toppings and size from the user's selections. If num_toppings indicates the special, then it gets the count for all the toppings for the special from the db. Otherwise, it sets the count to the num_toppings. Based on the count, it gets the topping selections for each of the pizza toppings indicated. It then gets the selected pizza type from the db and if not found, it sends an error to orders/error.html. Otherwise, it then gets the user's comments, or sets it to blank if not entered. Then it gets the session variables, grabs the pizza as the description for the order, and sets the order item to the details of the selected pizza in the db and saves. It then updates the session variables for the order. For each topping from the user's selections, it gets the item in the db. If not found, it sends an error to orders/error.html. Otherwise, it 
grabs the topping as the description for the order, and sets the order item to the details of the topping in the db and saves. It then sets up the display information for the user order and calls orders/viewCart.html. The get method checks if the user is authenticated and if not, it prompts the user to login. The get method checks if the user is authenticated and if not,it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it sets up the display information for the user to order regular pizza and toppings and calls orders/regPizza.html with the display info setup.

sic_pizza(): this method is only available to non-superusers so there is no check. The post method grabs the username and input for the num_toppings and size from the user's selections. If num_toppings indicates the special, then it gets the count for all the toppings for the special from the db. Otherwise, it sets the count to the num_toppings. Based on the count, it gets the topping selections for each of the pizza toppings indicated. It then gets the selected pizza type from the db and if not found, it sends an error to orders/error.html. Otherwise, it then gets the user's comments, or sets it to blank if not entered. Then it gets the session variables, grabs the pizza as the description for the order, and sets the order item to the details of the selected pizza in the db and saves. It then updates the session variables for the order. For each topping from the user's selections, it gets the item in the db. If not found, it sends an error to orders/error.html. Otherwise, it 
grabs the topping as the description for the order, and sets the order item to the details of the topping in the db and saves. It then sets the display information for the cart and calls orders/viewCart.html. The get method checks if the user is authenticated and if not,it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it sets up the display information for the user to order sicilian pizza and toppings and calls orders/sicPizza.html with the display info setup.

sub_order(): this method is only available to non-superusers so there is no check. The first thing it does is get the count of count of all sub toppings and then it reduces it by 4 (does not count extra cheese, mushrooms, onions, or green peppers since these are only avail for a price so they are handled separately). The post method grabs the username and input for the sub_type and size from the user's selections. Based on the count, it gets the topping selections for each of the sub toppings indicated. It then gets the selected sub type from the db and if not found, it sends an error to orders/error.html. Otherwise, it then gets the user's comments, or sets it to blank if not entered. Then it gets the session variables, grabs the sub as the description for the order, and sets the order item to the details of the selected sub in the db and saves. It then updates the session variables for the order. It then checks to see if the user selected extra cheese for the sub. If so, it is added to the list of toppings selected. Based on the sub's availability settings, if indicated it checks to see if the user selected the extra topping for the sub. If so, it is added to the list of topping selected.  For each topping from the user's selections, it gets the item in the db. If not found, it sends an error to orders/error.html. Otherwise, it grabs the topping as the description for the order, and sets the order item to the details of the topping in the db and saves. It then sets the display information for the cart and calls orders/viewCart.html. The get method checks if the user is authenticated and if not,it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it sets up the display information for the user to order subs, know which subs have mushrooms available, which subs have peppers available, which subs have onions available, the count of other toppings, the price of the extras, and the list of other sub toppings and then calls orders/subOrder.html with the display info setup.

pasta(): this method is only available to non-superusers so there is no check. The post method grabs the username and input for the pasta_type from the user's selections. It then gets the selected pasta type from the db and if not found, it sends an error to orders/error.html. Otherwise, it then gets the user's comments, or sets it to blank if not entered. Then it gets the session variables, grabs the pasta as the description for the order, and sets the order item to the details of the selected pasta in the db and saves. It then updates the session variables for the order. It then sets the display information for the cart and calls orders/viewCart.html. The get method checks if the user is authenticated and if not,it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it sets up the display information for the user to order pasta and calls orders/pasta.html with the display info setup.

salad(): this method is only available to non-superusers so there is no check. The post method grabs the username and input for the salad_type from the user's selections. It then gets the selected salad type from the db and if not found, it sends an error to orders/error.html. Otherwise, it then gets the user's comments, or sets it to blank if not entered. Then it gets the session variables, grabs the salad as the description for the order, and sets the order item to the details of the selected salad in the db and saves. It then updates the session variables for the order. It then sets the display information for the cart and calls orders/viewCart.html. The get method checks if the user is authenticated and if not,it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it sets up the display information for the user to order salad and calls orders/salad.html with the display info setup.

dinner(): this method is only available to non-superusers so there is no check. The post method grabs the username and input for the pasta_type, salad_type, and size from the user's selections. It then checks if salad_type has a selection and if so, it gets the selected salad and size fro the db and if not found, it indicates salad not found. If salad_type does not have a selection, then it checks if pasta_type has a selection. If so, it gets the selected pasta type from the db and if not found, it indicates pasta not found. Otherwise, it then gets the user's comments, or sets it to blank if not entered. If either a salad or pasta is found, it gets the session variables, 
grabs the dinner (pasta or salad) as the description for the order, and sets the order item to the details of the selected dinner in the db as either dinner salad or dinner pasta and saves. It then updates the session variables for the order. It then sets the display information for the cart and calls orders/viewCart.html. The get method checks if the user is authenticated and if not,it prompts the user to login. If authenticated, it gets the username and uses that to get the user data from the db. If the user is not found in the db, prompts the user to register. If the user is found, it sets up the display information for the user to order dinner pasta or dinner salad and calls orders/dinner.html with the display info setup.

# urls.py
File run within django to map the python views to the html files for django. It consists of the paths between the urls, views, and html files. 

# models.py
File run within django to setup the database models that define the tables to hold the data which django will create using sqlite. It consists of the models and table definitions for each. 

# apps.py
File run within django that defines the application (and folders) including orders and users. 

# admin.py
File run within django that registers the models for django. It registers each of the models.

# orders/templates folder - users folder
# base.html
File that defines the title and body block for the user html files.

# urs/login.html
Extends users/base.html. File that defines the block body for login, including Login heading, form for username and password with submit button, and link to registration page.

# register.html
Extends users/base.html. File that defines the block body for registration page, including Register heading and form for new user registration (username, password, email, first name, last name) plus submit button.

# orders/templates folder - orders folder
# base.html
File that loads static and defines the head html, which includes the block title. Defines the default page banner with maize and blue blocks, title, and image. Also setups up formatting for user block, cart block, header block, and body block.

# index.html
Extends orders/base.html. File that loads static and defines the index javascript to be used in the title block. Defines the user block based on if the username is passed in or not. Defines the cart block for non-superusers. Defines the header block which includes all the page tabs, placeOrder if the user is not a super user and orderStatus if they are a superuser with default set to index. Defines the body block to include all the menu items and buttons to add an item to the cart if the user is not a superuser.

# viewCart.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with order id and count, as well as the list of items currently in the cart along with a remove button for each item in the cart, the cart total, and links to placeOrder and index pages.

# error.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder if the user is not a super user and orderStatus if they are a superuser with default set based on calling view. Defines the body block to include the page title, as well as the error message, and a link to the index page.

# viewOrder.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder if the user is not a super user and orderStatus if they are a superuser with default set to viewOrder. Defines the body block to include the page title, as well as the list of orders sorted based on status with an update button for each item with status != Completed (only if the user is a superuser), and a link to the index page.

# placeOrder.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to placeOrder. Defines the body block to include the page title with order id, as well as the list of all items in the cart, the cart total,and links to viewCart and index pages.

# success.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to placeOrder. Defines the body block to include the page title, as well as the success message, and links to viewCart and index pages.

# orderStatus.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, orderStatus since the user must be a superuser to access this page and default set to orderStatus. Defines the body block to check if an order id is set. If not, then it prompts the user for the order id to view and update the order status. If so, then it displays all the items in the order including their status with an update button for those not completed, and links to viewOrder and index pages.

# regPizza.html
Extends orders/base.html. File that loads static and defines the pizza javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with a dropdown for the regular pizza type based on the size and numToppings settings, hidden dropdowns for the size and toppings list, a box for special instructions, plus a button for adding the selections to the cart, and a link to the index page.

# sicPizza.html
Extends orders/base.html. File that loads static and defines the pizza javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with a dropdown for the sicilian pizza type based on the size and numToppings settings, hidden dropdowns for the size and toppings list, a box for special instructions, plus a button for adding the selections to the cart, and a link to the index page.

# subOrder.html
Extends orders/base.html. File that loads static and defines the sub javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with a dropdown for the sub type based on the size and subType settings, hidden dropdowns for the extra cheese availability, mushrooms availability, peppers availability, onions availability, size, and toppings list, a box for special instructions, plus a button for adding the selections to the cart, and a link to the index page.

# salad.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with a dropdown for the salad type, a box for special instructions, plus a button for adding the selections to the cart, and a link to the index page.

# pasta.html
Extends orders/base.html. File that loads static and defines the order javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with a dropdown for the pasta type, a box for special instructions, plus a button for adding the selections to the cart, and a link to the index page.

# dinner.html
Extends orders/base.html. File that loads static and defines the dinner javascript to be used in the title block. Defines the header block which includes all the page tabs, placeOrder since the user must be a non-superuser to access this page and default set to index. Defines the body block to include the page title with a dropdown for the salad type based on the size and saladType settings as well as a dropdown for the pasta type based on the size and pastaType settings, hidden dropdowns for the size, a box for special instructions, plus a button for adding the selections to the cart, and a link to the index page.

# orders/static folder - orders folder
# index.js
File that defines the setup for the index html. If there is a user_name element in the document, then the login tab is greyed out, otherwise the logout tab is greyed out. It then calls load_page for the top of the page. It finally defines the querySelectAll for 'nav-link' forEach element onClick to call load_page with the link.dataset.page. 

window.onpopstate = e: function that updates the text on popping state so back button is enabled for webpage. It performs a smooth scroll based on e state text. If it is undefined or set to "/", it scrolls to the top. Otherwise it scrolls to whereever indicated by e state text.

load_page(): function passes in a name and sets the e state, including text, for enabling back button functionality plus smooth scrolls to location in "name".

format_selected_tab(): function passes in e_th, e_link in order to set menu tab highlight to indicated page.

format_old_tab(): function passes in e_th, e_link in order to set previously selected menu tab back to defaults.

# order.js
File that defines the setup for several html pages. Since there must be a user logged in on all of these pages, ensures the login tab is greyed out. 

# pizza.js
File that defines the setup for the regPizza and sicPizza html. Since there must be a user logged in on all of these pages, ensures the login tab is greyed out. It also sets all of the hidden elements to "none" display and disables the addtocart button to start. 

GetSelectedValue(): function that takes the numToppings input for user selection and gets the value and options selected innerHTML. It then gets the size out of the innerHTML and calls load_page with the value and size.

removeMessages(): function that clears out all but the default hidden topping selections.

load_page(): function passes in a size and num_toppings value. Sets the addtocart button to be displayed and calls removeMessages(). Sets the size dropdown selection index based on the size setting passed in. Then based on the num_toppings setting, displays the default topping selection dropdown if needed and adds dropdowns for any additional toppings for the pizza type selected by cloning the default (not hidden) topping selection dropdown. If the pizza selected is a special, then go through the default dropdown and find all the default topping selections for a special and then go through the topping selection dropdowns and set each appropriately to default all the selections for a special. This will all the user to just add the default special selections to the cart or change them if desired. 

# sub.js
File that defines the setup for the sub html. Since there must be a user logged in on all of these pages, ensures the login tab is greyed out. It also sets all of the hidden elements to "none" display and disables the addtocart button to start. 

GetSelectedValue(): function that takes the numToppings input for user selection and gets the value and options selected innerHTML. It then gets the size out of the innerHTML and calls load_page with the value and size.

removeMessages(): function that clears out all but the default hidden topping selections. Then it ensures the default topping1 dropdown is still hidden and all extras defaults are still hidden.

load_page(): function passes in a size and sub_type value. Sets the addtocart button to be displayed and calls removeMessages(). Sets the size dropdown selection index based on the size setting passed in. Gets the count from the hidden count element. Then based on the sub_type setting, displays the default topping selection dropdown and adds dropdowns for any additional toppings based on the count by cloning the default (not hidden) topping selection dropdown. Then grabs the hidden extras availability and adds dropdowns for the extras that are available by calling create_dropdown(). This will create topping dropdowns for all the sub toppings, including those with prices that are only available for specific sub types. Then the user can select all or none of the toppings for a given sub. 

create_dropdown(): function passes in an element id and description as well as the list id for the topping selections dropdown list. Creates a new dropdown with two options, the first is the default "Please Select" and the second is based on the element id and description. It then creates a list element with the list id and appends the new dropdown. It then appends the new list element to the list of topping selection dropdowns. 

# dinner.js
File that defines the setup for the dinner html. Since there must be a user logged in on all of these pages, ensures the login tab is greyed out. It also sets the addtocart button to disabbled.

GetSaladValue(): function that takes the saladType input for user selection and gets the value and salad options selected innerHTML. It then sets the pasta option selected to 0 since the user has selected a pasta value and they cannot select both pasta and salad. It finally gets the size out of the innerHTML and calls load_page with the size.

GetPastaValue(): function that takes the pastaType input for user selection and gets the value and pasta options selected innerHTML. It then sets the salad option selected to 0 since the user has selected a pasta value and they cannot select both pasta and salad. It finally gets the size out of the innerHTML and calls load_page with the value and size.

load_page(): function passes in a size value. Sets the addtocart button to be displayed and calls removeMessages(). It then sets the size dropdown selection index based on the size setting passed in. 
